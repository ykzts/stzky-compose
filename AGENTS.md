# Agents

このドキュメントでは、このリポジトリで使用されているエージェントと自動化について説明します。

## GitHub Actions

このリポジトリは、継続的インテグレーションと自動化タスクにGitHub Actionsを使用する場合があります。

## Renovate

このリポジトリは、依存関係の自動更新にRenovateを使用しています。設定は`.github/renovate.json5`にあります。

Renovateは自動的に以下を実行します:
- `compose.yaml`ファイル内のDockerイメージバージョンの更新
- `go.mod`内のGo依存関係の更新
- 依存関係更新のためのプルリクエストの作成
- 依存関係を安全かつ最新の状態に保つ

## 開発ツール

### yamlfmt

このリポジトリは、すべてのcomposeファイル間で一貫したYAMLフォーマットを確保するため、Goツール(`go.mod`で定義)として`yamlfmt`を使用しています。

フォーマッターを実行するには:

```bash
go tool yamlfmt
```

## サービス管理

このリポジトリの各サービスは以下のように設計されています:
- **自己完結型**: 各サービスディレクトリには独自の`compose.yaml`と設定が含まれています
- **独立性**: サービスは個別にデプロイおよび管理できます
- **自動化**: コンテナオーケストレーションを使用した自動再起動とヘルスチェック

## セキュリティ

- すべてのサービスは、再現性のためにSHA256ダイジェスト付きの特定のイメージバージョンを使用しています
- Renovateはセキュリティパッチでイメージを最新の状態に保ちます
- 機密性の高い設定には環境変数を使用します
- 該当する場合はヘルスチェックが設定されています

## コントリビューション

このリポジトリにコントリビュートする際は:
1. YAMLファイルが`yamlfmt`でフォーマットされていることを確認してください
2. SHA256ダイジェスト付きの特定のイメージバージョンを使用してください
3. 新しいサービスに適切なヘルスチェックを追加してください
4. 必要な環境変数を文書化してください
5. プルリクエストを提出する前にサービスをローカルでテストしてください

### コミットメッセージ

コミットメッセージは[Conventional Commits](https://www.conventionalcommits.org/)に従ってください。サービス単位で分けられている各ディレクトリの名前（`caddy`、`grafana`、`immich`、`uptime-kuma`など）をスコープとして利用します。

コミットメッセージの一行目はGitHubのUIに収まりやすいように、平易な英文で記述してください。

例:
- `feat(grafana): add prometheus configuration`
- `fix(caddy): update reverse proxy settings`
- `chore(immich): update docker image version`
